{
  "version": 3,
  "sources": ["../index.ts"],
  "sourcesContent": ["const ENDPOINT = `https://parley-api-t3y3w7eb4a-wl.a.run.app`;\nconst ATTR_TARGET_NAME = `parley-target`;\n\ninterface CarrierData {\n  dot_number: number;\n  icc_dockets: string;\n  legal_name: string;\n  physical_address: string;\n  telephone_number: string;\n  cellphone_number: string;\n  carrier_score: number;\n  insurance: string;\n  operating_authority: string;\n  safety_rating_desc: string;\n  rebroker_risk: string;\n  basic_measure_unsafe_driving: number;\n  basic_measure_hours_of_service: number;\n  basic_measure_driver_fitness: number;\n  basic_measure_controlled_substance: number;\n  basic_measure_vehicle_maintence: number;\n  basic_alert_unsafe_driving: string;\n  basic_alert_hours_of_service: string;\n  basic_alert_driver_fitness: string;\n  basic_alert_controlled_substance: string;\n  basic_alert_vehicle_maintence: string;\n}\n\ninterface CarrierData2 {\n  dot_number: number;\n  docket_prefix: string;\n  docket_number: number;\n  docket: string;\n  legal_name: string;\n  physical_address: string;\n  telephone_number: string;\n  cellphone_number: string;\n  fax_number: string;\n  carrier_score: number;\n  insurance: string;\n  operating_authority: string;\n  safety_rating_desc: string;\n  rebroker_risk: string;\n  basic_measure_unsafe_driving: number;\n  basic_measure_hours_of_service: number;\n  basic_measure_driver_fitness: number;\n  basic_measure_controlled_substance: number;\n  basic_measure_vehicle_maintence: number;\n  basic_alert_unsafe_driving: string;\n  basic_alert_hours_of_service: string;\n  basic_alert_driver_fitness: string;\n  basic_alert_controlled_substance: string;\n  basic_alert_vehicle_maintence: string;\n  inspections_total: number;\n  last_inspection_date: string;\n  authority_common: string;\n  insurance_bipd_on_file: number;\n  insurance_bond_on_file: number;\n  insurance_cargo_on_file: number;\n}\n\nconst init = async () => {\n  // select UI elements\n  const targets: NodeList = document.querySelectorAll(`[${ATTR_TARGET_NAME}]`);\n  const loader = document.querySelector<HTMLDivElement>(\n    '[data-parley=\"loader\"]'\n  );\n  if (!loader) return;\n\n  // listen for form submission\n  const form = document.querySelector(\"form\");\n  if (!form) return;\n\n  // define data fetching function\n  const getData = async (num): Promise<CarrierData2 | null> => {\n    try {\n      const response = await fetch(`${ENDPOINT}/${num}`);\n      if (response.status === 404) {\n        alert(`No records found for DOT Number ${num}`);\n        return null;\n      }\n      const data: CarrierData2 = await response.json();\n      console.log({ data });\n      return data;\n    } catch (error) {\n      console.log({ error });\n      return null;\n    }\n  };\n\n  // UI updating function\n  const updateUI = (data: CarrierData2) => {\n    targets.forEach((target) => {\n      let el = target as Element;\n      let val = data[String(el.getAttribute(ATTR_TARGET_NAME))];\n\n      //   console.log(el.getAttribute(ATTR_TARGET_NAME));\n      //   console.log({ val });\n\n      if (val === undefined || val === null) {\n        val = \"No data\";\n      }\n      if (el.getAttribute(ATTR_TARGET_NAME) === \"carrier_score\") {\n        val = val * 100;\n      }\n      if (\n        el.getAttribute(ATTR_TARGET_NAME) === \"insurance_bipd_on_file\" ||\n        el.getAttribute(ATTR_TARGET_NAME) === \"insurance_cargo_on_file\"\n      ) {\n        const formatter = new Intl.NumberFormat(\"en-US\", {\n          style: \"currency\",\n          currency: \"USD\",\n          minimumFractionDigits: 0,\n          maximumFractionDigits: 0,\n        });\n        val = formatter.format(val);\n      }\n      val = val.toString();\n\n      if (val.toLowerCase() === \"false\" || val.toLowerCase() === \"true\") {\n        val = val.toLowerCase();\n        val = \"false\" ? \"NO\" : \"YES\";\n      }\n      if (\n        el.getAttribute(ATTR_TARGET_NAME) === \"telephone_number\" ||\n        el.getAttribute(ATTR_TARGET_NAME) === \"cellphone_number\" ||\n        el.getAttribute(ATTR_TARGET_NAME) === \"fax_number\"\n      ) {\n        if (val.length === 10) {\n          val = formatPhoneNumber(val);\n        }\n      }\n      if (val === \"\") {\n        val = \"No data\";\n      }\n\n      //console.log({ 'val after processing': val })\n      target.textContent = val;\n    });\n  };\n\n  // function to run on form submit\n  const formSubmit = async (event) => {\n    event.preventDefault();\n    const dotNumber = form.querySelector<HTMLInputElement>(\n      '[parley-form=\"dot-number\"]'\n    )?.value;\n    // call getData for DOT Number submitted through form\n    loader.classList.add(\"is-visible\");\n    const data = await getData(dotNumber);\n    // Update UI\n    if (!data) {\n      console.log(\"error getting carrier data!\");\n    } else {\n      updateUI(data);\n    }\n    setTimeout(() => {\n      loader.classList.remove(\"is-visible\");\n    }, 1000);\n  };\n  form.addEventListener(\"submit\", formSubmit);\n};\n\nfunction formatPhoneNumber(phoneNumberString) {\n  var cleaned = (\"\" + phoneNumberString).replace(/\\D/g, \"\");\n  var match = cleaned.match(/^(\\d{3})(\\d{3})(\\d{4})$/);\n  if (match) {\n    return \"(\" + match[1] + \") \" + match[2] + \"-\" + match[3];\n  }\n  return null;\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", init);\n"],
  "mappings": ";;AAAA,MAAM,WAAW;AACjB,MAAM,mBAAmB;AA2DzB,MAAM,OAAO,YAAY;AAEvB,UAAM,UAAoB,SAAS,iBAAiB,IAAI,mBAAmB;AAC3E,UAAM,SAAS,SAAS;AAAA,MACtB;AAAA,IACF;AACA,QAAI,CAAC;AAAQ;AAGb,UAAM,OAAO,SAAS,cAAc,MAAM;AAC1C,QAAI,CAAC;AAAM;AAGX,UAAM,UAAU,OAAO,QAAsC;AAC3D,UAAI;AACF,cAAM,WAAW,MAAM,MAAM,GAAG,YAAY,KAAK;AACjD,YAAI,SAAS,WAAW,KAAK;AAC3B,gBAAM,mCAAmC,KAAK;AAC9C,iBAAO;AAAA,QACT;AACA,cAAM,OAAqB,MAAM,SAAS,KAAK;AAC/C,gBAAQ,IAAI,EAAE,KAAK,CAAC;AACpB,eAAO;AAAA,MACT,SAAS,OAAP;AACA,gBAAQ,IAAI,EAAE,MAAM,CAAC;AACrB,eAAO;AAAA,MACT;AAAA,IACF;AAGA,UAAM,WAAW,CAAC,SAAuB;AACvC,cAAQ,QAAQ,CAAC,WAAW;AAC1B,YAAI,KAAK;AACT,YAAI,MAAM,KAAK,OAAO,GAAG,aAAa,gBAAgB,CAAC;AAKvD,YAAI,QAAQ,UAAa,QAAQ,MAAM;AACrC,gBAAM;AAAA,QACR;AACA,YAAI,GAAG,aAAa,gBAAgB,MAAM,iBAAiB;AACzD,gBAAM,MAAM;AAAA,QACd;AACA,YACE,GAAG,aAAa,gBAAgB,MAAM,4BACtC,GAAG,aAAa,gBAAgB,MAAM,2BACtC;AACA,gBAAM,YAAY,IAAI,KAAK,aAAa,SAAS;AAAA,YAC/C,OAAO;AAAA,YACP,UAAU;AAAA,YACV,uBAAuB;AAAA,YACvB,uBAAuB;AAAA,UACzB,CAAC;AACD,gBAAM,UAAU,OAAO,GAAG;AAAA,QAC5B;AACA,cAAM,IAAI,SAAS;AAEnB,YAAI,IAAI,YAAY,MAAM,WAAW,IAAI,YAAY,MAAM,QAAQ;AACjE,gBAAM,IAAI,YAAY;AACtB,gBAAM,UAAU,OAAO;AAAA,QACzB;AACA,YACE,GAAG,aAAa,gBAAgB,MAAM,sBACtC,GAAG,aAAa,gBAAgB,MAAM,sBACtC,GAAG,aAAa,gBAAgB,MAAM,cACtC;AACA,cAAI,IAAI,WAAW,IAAI;AACrB,kBAAM,kBAAkB,GAAG;AAAA,UAC7B;AAAA,QACF;AACA,YAAI,QAAQ,IAAI;AACd,gBAAM;AAAA,QACR;AAGA,eAAO,cAAc;AAAA,MACvB,CAAC;AAAA,IACH;AAGA,UAAM,aAAa,OAAO,UAAU;AAClC,YAAM,eAAe;AACrB,YAAM,YAAY,KAAK;AAAA,QACrB;AAAA,MACF,GAAG;AAEH,aAAO,UAAU,IAAI,YAAY;AACjC,YAAM,OAAO,MAAM,QAAQ,SAAS;AAEpC,UAAI,CAAC,MAAM;AACT,gBAAQ,IAAI,6BAA6B;AAAA,MAC3C,OAAO;AACL,iBAAS,IAAI;AAAA,MACf;AACA,iBAAW,MAAM;AACf,eAAO,UAAU,OAAO,YAAY;AAAA,MACtC,GAAG,GAAI;AAAA,IACT;AACA,SAAK,iBAAiB,UAAU,UAAU;AAAA,EAC5C;AAEA,WAAS,kBAAkB,mBAAmB;AAC5C,QAAI,WAAW,KAAK,mBAAmB,QAAQ,OAAO,EAAE;AACxD,QAAI,QAAQ,QAAQ,MAAM,yBAAyB;AACnD,QAAI,OAAO;AACT,aAAO,MAAM,MAAM,KAAK,OAAO,MAAM,KAAK,MAAM,MAAM;AAAA,IACxD;AACA,WAAO;AAAA,EACT;AAEA,WAAS,iBAAiB,oBAAoB,IAAI;",
  "names": []
}
